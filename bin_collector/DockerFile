# Start from a base Go image
FROM golang:1.18-alpine

# Install necessary dependencies
RUN apk add --no-cache bash jq ca-certificates

# Set the working directory
WORKDIR /app

# Copy Go module files and download dependencies
COPY go.mod ./
RUN go mod download

# Copy the Go source code and build it
COPY main.go ./
RUN go build -o waste-collection main.go

# Copy additional files needed for runtime
COPY template.html /app/template.html  # Assuming this file exists
COPY static /app/static  # Assuming this folder exists
COPY config.json /app/config.json  # Assuming this file exists
COPY run.sh /app/run.sh

# Make the run.sh file executable
RUN chmod +x /app/run.sh

# Use the run.sh script as the entry point
CMD ["/app/run.sh"]